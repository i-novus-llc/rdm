<?xml version='1.0' encoding='UTF-8'?>
<object xmlns="http://n2oapp.net/framework/config/schema/object-3.0" name="Справочник">

    <operations>
        <operation id="create" submit-label="Сохранить" success-text="Справочник успешно сохранен">
            <invocation>
                <rest method="POST">/refBook</rest>
            </invocation>

            <in-parameters>
                <param id="code" mapping="code" domain="string" mapper="spel"/>
                <param id="name" mapping="passport.name" domain="string" mapper="spel"/>
                <param id="shortName" mapping="passport.shortName" domain="string" mapper="spel"/>
                <param id="description" mapping="passport.description" domain="string" mapper="spel"/>
            </in-parameters>

            <out-parameters>
                <param id="refBookId" mapping="['refBookId']" domain="integer"/>
            </out-parameters>

        </operation>

        <operation id="edit" submit-label="Изменить" success-text="Справочник успешно изменен">
            <invocation>
                <java method="editPassport" class="ru.inovus.ms.rdm.service.CreateDraftController">
                    <spring/>
                    <arguments>
                        <argument class="ru.inovus.ms.rdm.model.RefBookUpdateRequest" name="refBookUpdateRequest"/>
                    </arguments>
                </java>
            </invocation>
            <in-parameters>
                <param id="version.id" mapping="[0].versionId" domain="integer" mapper="spel"/>
                <param id="code" mapping="[0].code" domain="string" mapper="spel"/>
                <param id="name" mapping="[0].passport['name']" domain="string" mapper="spel"/>
                <param id="shortName" mapping="[0].passport['shortName']" domain="string" mapper="spel"/>
                <param id="description" mapping="[0].passport['description']" domain="string" mapper="spel"/>
            </in-parameters>
            <out-parameters>
                <param id="id" mapping="id" domain="integer"/>
            </out-parameters>
        </operation>

        <operation id="delete" submit-label="Удалить" success-text="Справочник удален"
                   confirm="true" confirm-text="Вы уверены что хотите удалить этот справочник?">
            <invocation>
                <rest method="DELETE">/refBook?refBookId={refBookId}</rest>
            </invocation>
            <in-parameters>
                <param id="refBookId" mapping="refBookId" domain="integer" mapper="spel"/>
            </in-parameters>
        </operation>

        <operation id="publish" submit-label="Опубликовать" success-text="Справочник опубликован"
                   confirm="true" confirm-text="Вы уверены что хотите опубликовать этот справочник?">
            <invocation>
                <rest method="POST">/draft/{draftId}/publish</rest>
            </invocation>
            <in-parameters>
                <param id="version.id" mapping="draftId" domain="integer" mapper="spel"/>
            </in-parameters>
        </operation>

        <operation id="upload" submit-label="Загрузить" success-text="Данные загружены">
            <invocation>
                <java class="ru.inovus.ms.rdm.service.CreateDraftController"
                      method="uploadFromFile">
                    <spring/>
                    <arguments>
                        <argument type="primitive" name="versionId" class="java.lang.Integer"/>
                        <argument type="class" name="fileModel" class="ru.inovus.ms.rdm.model.FileModel"/>
                    </arguments>
                </java>
            </invocation>
            <in-parameters>
                <param id="versionId" mapping="[0]" domain="integer"/>
                <param id="file.path" mapping="[1].path" domain="string"/>
                <param id="file.name" mapping="[1].name" domain="string"/>
            </in-parameters>
            <out-parameters>
                <param id="refBookId" mapping="refBookId" domain="integer"/>
            </out-parameters>
        </operation>
    </operations>

</object>